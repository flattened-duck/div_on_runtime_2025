# PyDivKit Web Server

–ú–æ–¥—É–ª—å–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ pydivkit DSL, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç DivKit JSON –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
python/
‚îú‚îÄ‚îÄ server.py          # Flask –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ endpoints
‚îú‚îÄ‚îÄ config.py          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –∏ HTML —à–∞–±–ª–æ–Ω—ã
‚îú‚îÄ‚îÄ divkit_layouts/    # üì¶ DSL –º–æ–¥—É–ª—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è DivKit –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py    # –≠–∫—Å–ø–æ—Ä—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ components.py  # –§—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ templates.py   # –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–µ–º–ø–ª–µ–π—Ç—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ utils.py       # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Å—Ç—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ pydivkit/          # PyDivKit DSL –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
‚îî‚îÄ‚îÄ tests/             # –¢–µ—Å—Ç—ã
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source env/bin/activate

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
poetry install
```

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
python server.py
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:8080`

## üìç –î–æ—Å—Ç—É–ø–Ω—ã–µ endpoints

| Endpoint | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------|----------|
| `/` | GET | –ì–ª–∞–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ |
| `/divruntime` | GET | –ü–æ–ª—É—á–∏—Ç—å DivKit JSON –¥–ª—è HelloWorld –ø—Ä–∏–º–µ—Ä–∞ |
| `/health` | GET | Health check —Å–µ—Ä–≤–µ—Ä–∞ |

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–ª—É—á–∏—Ç—å DivKit JSON

```bash
curl "http://localhost:8080/divruntime" | python -m json.tool
```

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞

–°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π DivKit JSON —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

```json
{
  "templates": {},
  "card": {
    "log_id": "card",
    "states": [
      {
        "state_id": 0,
        "div": {
          "type": "container",
          "items": [
            {
              "type": "text",
              "text": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ PyDivKit!",
              "font_size": 28,
              "font_weight": "bold",
              "text_alignment_horizontal": "center",
              "text_color": "#2c3e50"
            },
            {
              "type": "text", 
              "text": "Hello, World!",
              "font_size": 24,
              "background": [{"type": "solid", "color": "#f0f8ff"}],
              "border": {"corner_radius": 12}
            }
          ]
        }
      }
    ]
  }
}
```

## üõ† –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ–º–ø–ª–µ–π—Ç–æ–≤

–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å –≤ `divkit_layouts/templates.py`:

```python
class MyCustomTemplate(dk.DivContainer):
    title: str = dk.Field()
    color: str = dk.Field(default="#000000")
    
    items = [
        dk.DivText(
            text=dk.Ref(title),
            text_color=dk.Ref(color)
        )
    ]
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –≤ `divkit_layouts/components.py`:

```python
def create_my_component():
    return dk.DivText(text="My Component")
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Ç–∏–ª–∏—Ç

–ë—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ `divkit_layouts/utils.py`:

```python
from divkit_layouts import create_simple_text, create_button, create_card

# –ü—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç
text = create_simple_text("–ó–∞–≥–æ–ª–æ–≤–æ–∫", size=24, color="#2c3e50")

# –ö–Ω–æ–ø–∫–∞ —Å –¥–µ–π—Å—Ç–≤–∏–µ–º
button = create_button("–ù–∞–∂–∞—Ç—å", "div-action://click", bg_color="#e74c3c")

# –ö–∞—Ä—Ç–æ—á–∫–∞ 
card = create_card([text, button], bg_color="#f8f9fa")
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö endpoints

–î–æ–±–∞–≤—å—Ç–µ –≤ `server.py`:

```python
from divkit_layouts import create_simple_text
import pydivkit as dk

@app.route('/my-endpoint')
def my_endpoint():
    result = create_simple_text("My Component")
    return jsonify(dk.make_div(result))
```

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [DivKit Documentation](https://divkit.tech/)
- [PyDivKit GitHub](https://github.com/divkit/divkit/tree/main/json-builder/python)

## üìù –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

- **`server.py`** - Flask routes –∏ HTTP –ª–æ–≥–∏–∫–∞
- **`config.py`** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Å—Ç–∞—Ç–∏—á–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç  
- **`divkit_layouts/`** - DSL –º–æ–¥—É–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
  - **`components.py`** - —Å–ª–æ–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è DivKit —Å—Ç—Ä—É–∫—Ç—É—Ä
  - **`templates.py`** - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ–º–ø–ª–µ–π—Ç—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏  
  - **`utils.py`** - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Å—Ç—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  - **`__init__.py`** - —É–¥–æ–±–Ω—ã–π API –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –º–æ–¥—É–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

- ‚úÖ –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏ DSL –ª–æ–≥–∏–∫–∏
- ‚úÖ –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–µ–º–ø–ª–µ–π—Ç—ã –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ
- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DSL –º–æ–¥—É–ª—è –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö
- ‚úÖ –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è

## üêõ –û—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `poetry install`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 8080 —Å–≤–æ–±–æ–¥–µ–Ω: `lsof -i :8080`
